# ğŸª Cookie Header æµ‹è¯•æŒ‡å—

## å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
# æˆ–
yarn dev
```

### 2. æ‰“å¼€æµ‹è¯•é¡µé¢

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
```
http://localhost:3000/test-cookie.html
```

### 3. æŸ¥çœ‹æµ‹è¯•ç»“æœ

#### æ–¹æ³• Aï¼šä½¿ç”¨æµ‹è¯•é¡µé¢ï¼ˆæ¨èï¼‰
1. ç‚¹å‡» "æµ‹è¯• 1" æŒ‰é’® - ä¼šæ˜¾ç¤ºæµè§ˆå™¨é˜»æ­¢ Cookie çš„æƒ…å†µ
2. ç‚¹å‡» "æµ‹è¯• 2" æŒ‰é’® - ä¼šé€šè¿‡æœåŠ¡ç«¯æˆåŠŸå‘é€ Cookie
3. åŒæ—¶æŸ¥çœ‹**ç»ˆç«¯/æ§åˆ¶å°**çš„è¾“å‡ºæ—¥å¿—

#### æ–¹æ³• Bï¼šåœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œ test.js
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. æ‰“å¼€ Console é€‰é¡¹å¡
3. å°† `test.js` çš„å†…å®¹ç²˜è´´åˆ°æ§åˆ¶å°
4. æŒ‰å›è½¦è¿è¡Œ

## æµ‹è¯•è¯´æ˜

### æµ‹è¯• 1ï¼šæµè§ˆå™¨ç›´æ¥è®¾ç½® Cookie âŒ
- **ç›®çš„**: æ¼”ç¤ºæµè§ˆå™¨é˜»æ­¢æ‰‹åŠ¨è®¾ç½® Cookie header
- **ç»“æœ**: Cookie ä¸ä¼šè¢«å‘é€
- **åŸå› **: æµè§ˆå™¨å®‰å…¨ç­–ç•¥

### æµ‹è¯• 2ï¼šé€šè¿‡æœåŠ¡ç«¯ API âœ…
- **ç›®çš„**: æ¼”ç¤ºæœåŠ¡ç«¯å¯ä»¥æ­£å¸¸è®¾ç½® Cookie header
- **ç»“æœ**: Cookie æˆåŠŸå‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨
- **æŸ¥çœ‹**: åœ¨ç»ˆç«¯ä¸­æŸ¥çœ‹æœåŠ¡ç«¯æ‰“å°çš„æ—¥å¿—

## æŸ¥çœ‹è¯·æ±‚å¤´çš„æ–¹æ³•

### 1. ä½¿ç”¨æµ‹è¯• API è·¯ç”±
æµ‹è¯• API ä¼šæ¥æ”¶è¯·æ±‚å¹¶æ‰“å°æ‰€æœ‰ headersï¼š
```javascript
fetch('/api/test-headers', {
  method: 'POST',
  headers: { 'Cookie': 'test=123' }
})
```

### 2. æŸ¥çœ‹æœåŠ¡ç«¯æ—¥å¿—
åœ¨ç»ˆç«¯ä¸­ä¼šçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
=== æ¥æ”¶åˆ°çš„è¯·æ±‚å¤´ ===
{
  "content-type": "application/json",
  "cookie": "test=abc123; session=xyz789",
  ...
}
Cookie Header: test=abc123; session=xyz789
======================
```

### 3. ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·
1. æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° **Network** æ ‡ç­¾
3. å‘é€è¯·æ±‚
4. ç‚¹å‡»è¯·æ±‚æŸ¥çœ‹è¯¦æƒ…
5. åœ¨ **Headers** æ ‡ç­¾ä¸­æŸ¥çœ‹ï¼š
   - **Request Headers**: æŸ¥çœ‹å®é™…å‘é€çš„è¯·æ±‚å¤´
   - **æ³¨æ„**: Cookie header å¯èƒ½ä¸ä¼šæ˜¾ç¤ºæ‚¨æ‰‹åŠ¨è®¾ç½®çš„å€¼

### 4. ä½¿ç”¨æŠ“åŒ…å·¥å…·ï¼ˆé«˜çº§ï¼‰
- **Fiddler** (Windows)
- **Charles Proxy** (è·¨å¹³å°)
- **Wireshark** (ç½‘ç»œåè®®åˆ†æ)

## æ ¸å¿ƒæ¦‚å¿µ

### ä¸ºä»€ä¹ˆæµè§ˆå™¨ä¼šé˜»æ­¢ï¼Ÿ
- **å®‰å…¨æ€§**: é˜²æ­¢æ¶æ„è„šæœ¬çªƒå–æˆ–ä¼ªé€  Cookie
- **éšç§ä¿æŠ¤**: Cookie å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ session tokenï¼‰
- **æµè§ˆå™¨ç­–ç•¥**: æŸäº› headers è¢«æ ‡è®°ä¸º"ç¦æ­¢ä¿®æ”¹"

### è§£å†³æ–¹æ¡ˆ
| ç¯å¢ƒ | èƒ½å¦è®¾ç½® Cookie | è¯´æ˜ |
|------|---------------|------|
| ğŸŒ æµè§ˆå™¨ | âŒ | è¢«æµè§ˆå™¨é˜»æ­¢ |
| ğŸ–¥ï¸ Next.js API è·¯ç”± | âœ… | åœ¨æœåŠ¡ç«¯è¿è¡Œï¼Œæ— é™åˆ¶ |
| ğŸ–¥ï¸ Node.js è„šæœ¬ | âœ… | åœ¨æœåŠ¡ç«¯è¿è¡Œï¼Œæ— é™åˆ¶ |

### æ­£ç¡®çš„åšæ³•

#### âŒ é”™è¯¯ï¼ˆæµè§ˆå™¨ä¸­ï¼‰
```javascript
// åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ - Cookie ä¼šè¢«å¿½ç•¥
fetch('https://api.example.com', {
  headers: { 'Cookie': 'session=abc' }
})
```

#### âœ… æ­£ç¡®ï¼ˆæœåŠ¡ç«¯ API è·¯ç”±ï¼‰
```typescript
// src/app/api/proxy/route.ts
export async function POST(request: Request) {
  return fetch('https://api.example.com', {
    headers: { 
      'Cookie': 'session=abc'  // âœ… åœ¨æœåŠ¡ç«¯å¯ä»¥å·¥ä½œ
    }
  })
}
```

```javascript
// åœ¨æµè§ˆå™¨ä¸­è°ƒç”¨æ‚¨çš„ API
fetch('/api/proxy', { method: 'POST' })
```

## æ–‡ä»¶è¯´æ˜

- `src/app/api/test-headers/route.ts` - æ¥æ”¶è¯·æ±‚å¹¶æ‰“å° headers
- `src/app/api/cursor/me/route.ts` - å¸¦ Cookie çš„å®é™…è¯·æ±‚ç¤ºä¾‹
- `public/test-cookie.html` - å¯è§†åŒ–æµ‹è¯•é¡µé¢
- `test.js` - æµ‹è¯•è„šæœ¬

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆåœ¨ Network é¢æ¿çœ‹ä¸åˆ°æˆ‘è®¾ç½®çš„ Cookieï¼Ÿ
A: å› ä¸ºæµè§ˆå™¨åœ¨å‘é€è¯·æ±‚å‰å°±è¿‡æ»¤æ‰äº†æ‰‹åŠ¨è®¾ç½®çš„ Cookie headerã€‚

### Q: å¦‚ä½•åœ¨æµè§ˆå™¨ä¸­å‘é€ Cookieï¼Ÿ
A: ä½¿ç”¨ `credentials: 'include'` è®©æµè§ˆå™¨è‡ªåŠ¨å‘é€ï¼š
```javascript
fetch('https://api.example.com', {
  credentials: 'include'  // è‡ªåŠ¨å‘é€æµè§ˆå™¨ä¸­çš„ Cookie
})
```

### Q: Node.js ç¯å¢ƒå¯ä»¥è®¾ç½® Cookie å—ï¼Ÿ
A: å¯ä»¥ï¼åœ¨ Node.js ä¸­æ²¡æœ‰æµè§ˆå™¨çš„é™åˆ¶ï¼š
```bash
node test.js  # åœ¨ Node.js ä¸­è¿è¡Œï¼ŒCookie å¯ä»¥æ­£å¸¸å‘é€
```

### Q: æœåŠ¡ç«¯ API è·¯ç”±çœŸçš„èƒ½å‘é€ Cookie å—ï¼Ÿ
A: æ˜¯çš„ï¼æ‚¨çš„ `/api/cursor/me` è·¯ç”±åœ¨æœåŠ¡ç«¯è¿è¡Œï¼Œå¯ä»¥æ­£å¸¸è®¾ç½®ä»»ä½• headerã€‚

## éªŒè¯æˆåŠŸçš„æ ‡å¿—

âœ… **æµ‹è¯• 1** - ä¼šæ˜¾ç¤º Cookie æœªä¼ é€’ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼‰
âœ… **æµ‹è¯• 2** - åœ¨ç»ˆç«¯ä¸­çœ‹åˆ°æœåŠ¡ç«¯æ—¥å¿—ï¼Œæ˜¾ç¤º Cookie ä¿¡æ¯

è®°ä½ï¼š**åœ¨æµè§ˆå™¨ä¸­æ— æ³•æ‰‹åŠ¨è®¾ç½® Cookie headerï¼Œè¿™æ˜¯æµè§ˆå™¨çš„å®‰å…¨ç‰¹æ€§ï¼**


